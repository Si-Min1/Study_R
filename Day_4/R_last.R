### ?????? ???? ###
#############################
### read.csv?? ?ѱ??? ?ִ? ?ڷ? open
getwd()
setwd('
:/Sources/Study_R/Day_4')

ls()
rm(list=ls())

df=read.csv('./data_r/cust_order_data.csv',sep='\t',encoding='ANSI',stringsAsFactor = TRUE)
df=read.csv('./data_r/cust_order_data.csv',sep='\t',encoding='ANSI')



# CUST_SERIAL_NO: ???ȣ고객번호 / SEX: 고객성별 / AGE: 고객나이 / REG_DATE: 등록일자
# ORDER_DATE: 주문날짜 / ORDER_HOUR: 주문시간 / ORDER_WEEKDAY: 주문요일
# IS_WEEKEND: 주문한날이 주말인가? / GOODS_CODE: 상품코드
# LGROUP: 대분류 / MGROUP: 중분류 / SGROUP: 소분류 / DGROUP: 
# GOOD_NAME: 상품명 / PRICE: 상품가격 / QTY: 구매건수ƴ? *?일부 데이터에 값이 아닌 *가 들어가 있는 경우가 있어서 사용할 수 없는 데이터는 제거한다il(df$SEX)
# ???? *?? factor???¿??? ??????계속 *이 factor상태에선 레벨단위에 남아있어서 char형으로 바꿨다가 돌리기)

str(df)
data.frame(head(df,10))

#????????, ????, ???? ?Ǽ??? ?????Ͽ? ?구매일자, 성별, 구매 건수만 추출하여 별도의 데이터 프레임을 만든다Y))
head(sex1)
str(sex1)

# ???????ڿ??? ?? ???? ?????ϱ? ?? lubridate구매일자에서 월 정보만 추출하기 위한 lubridate 라이브러리를 설치한다ORDER_DATE ???? ?????Ǿ? ?ִ? ??¥?? ?̿??Ͽ? month ?Լ???
# ????열에 저장되어 있는 날짜를 이용하여 month 함수로
# 월만 추출해서 month 라는 새로운 열을 추가한다ex2,5)

# ?????? ?? ?? reshape2 ???̺귯???? ??ġ?Ѵ?.
install데이터 조작을 위해 reshape2 라이브러리를 설치한다?? ???? ?Ǽ??? ???? ???ؼ? Ȯ???Ѵ?.
dcast(sex

# 성별로 구분하여 월별 구매 건수의 총합을 구해서 확인한다.
dcast(sex2, SEX ~ month, value.var = 'QTY', sum)


??나 M 대신 female, male이라고 표시하기 위해서
# 변환 함수를 만들어서 적용하여 gender라는 열을 추가한다
# 아니 왜 전부 female이 되냐return('female') 
	}
}
str(sex2)
sex2$gender = apply(sex2,2,changeGender)
table(sex2$gender)
tail(sex2)


### ȭ?? ???? ###
library(ggplot2)

# ???? ???? ???? ???? ?Ǽ??? ???? ???? ?׷??? ǥ화면 출력?????? ?̻??Ѱ? ???⵵
# 성별 별로 월별 구매 건수를 누적 막대 그래프로 표시한다
# 결과가 이상한거 같기도하고eom_bar()+facet_wrap(~SEX)


## ???ɴ? ???? ?이거는 왜 맞지 ????, ???? ?Ǽ? ?? ?????Ͽ? ?????? ?????? ???? ??????연령대 구매 건수

#구매일자, 나이, 구매 건수 만 추출하여 별도의 데이터 프레임을 만든다 ??¥?? ?̿??Ͽ? month ?Լ???
# '???? ????'?ؼ? month ???? ???ο? ?? ?߰??열에 저장되어 있는 날짜를 이용하여 month 함수로
# '월만 추출'해서 month 라는 새로운 열을 추가한다. 

# cbind()는 column bind의 약자입니다.  
# cbind()도 열 결합을 하려고 하면 서로 결합하려는 두 데이터셋의 관측치가
# 행이 서로 동일 대상이어야만 하고, 행의 갯수가 서로 같아야만 합니다?ؼ? Ȯ???Ѵ?.
	    # ???̸??? ?? ?????ؼ? ???ŰǼ??? ???ؼ? ???연령별로 구분하여 월별 구매 건수의 총합을 구해서 확인한다.
# 나이를행 월을 열로해서 구매건수를 합해서 보여줘라???룢?? ?ٿ??? ages???? ?? ?߰??Ѵ?.
age2 <- 그래프에 표시할 때, 10대, 20대, 30대와 같이
# 표시될 수 있도록 나이에 “대＂를 붙여서 ages라는 열을 추가한다nth,data=age2,geom='bar',fill=ages)

# ???? ???? ???? ???? ?Ǽ?연령 별로 월별 구매 건수를 누적 막대 그래프로 표시한다eom_bar()+facet_wrap(~AGE)


## ????/???ɴ? ????연령 별로 월별 구매 건수를 별도의 막대 그래프로 표시한다???? ???? ??????.
sexage1 <- subset(df,select=c(ORDER_성별/연령대 구매 건수

#구매일자, 성별, 나이, 구매 건수만 추출하여 별도의 데이터 프레임을 만든다 ???? ???? ???ļ? Ȯ???Ѵ?
sexage2 <- ddply(sexage1, .(ORDER_DATE,SEX,AGE), summarize, Sum_F=s함수를 사용하여 날짜, 성별, 나이로 그룹을 지어 구매 수량을 합쳐서 확인한다????? ???̿? ???룢?? ?ٿ??? ?߰??Ѵ?.
sexage3 <- cbind(sexage2, month=month(sexage2$ORDER_DATE))
sexa함수로 월만 추출하여 month 열을 추가하고, ages 열에는 나이에 “대＂를 붙여서 추가한다? ???? ???? ?Ǽ??? ?????? ???? ?׷??? ǥ???Ѵ?.
ggplot(sexage3,aes(month))+geom_bar()+facet_wrap(~SEX+ages)


## ???ɴ?/???? ???? ?성별과 연령을 기준으로 월별 구매 건수를 별도의 막대 그래프로 표시한다um(QTY))

sexage5 <- cbind(sexage4, month=month(sexage4$ORDER_DATE)연령대/성별 구매 건수 (리버스)
es=paste(sexage5$AGE,"??"))

ggplot(sexage3,aes(month))+geom_bar()+facet_wrap(~ages+SEX)


## ???? ??? ???űݾ?

# ????????, ? ??ȣ, ???? ?ݾ? ?? ?????Ͽ? ?????? ?????? ???? ??????.
cust1 <- subset(df, select=c(ORDER_DATE,CUST_SERIAL_NO,PRICE))

## 월별 고객단위 구매금액

# 구매일자, 고객 번호, 구매 금액 만 추출하여 별도의 데이터 프레임을 만든다